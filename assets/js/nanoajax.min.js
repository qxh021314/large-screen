// https://github.com/yanatan16/nanoajax
// @log delete setDefault(headers, 'X-Requested-With', 'XMLHttpRequest')
!function(t,e){function n(t){return t&&e.XDomainRequest&&!/MSIE 1/.test(navigator.userAgent)?new XDomainRequest:e.XMLHttpRequest?new XMLHttpRequest:void 0}function o(t,e,n){t[e]=t[e]||n}var r=["responseType","withCredentials","timeout","onprogress"];t.ajax=function(t,a){function s(t,e){return function(){c||(a(void 0===f.status?t:f.status,0===f.status?"Error":f.response||f.responseText||e,f),c=!0)}}var u=t.headers||{},i=t.body,d=t.method||(i?"POST":"GET"),c=!1,f=n(t.cors);f.open(d,t.url,!0);var l=f.onload=s(200);f.onreadystatechange=function(){4===f.readyState&&l()},f.onerror=s(null,"Error"),f.ontimeout=s(null,"Timeout"),f.onabort=s(null,"Abort"),i&&(e.FormData&&i instanceof e.FormData||o(u,"Content-Type","application/x-www-form-urlencoded"));for(var p,m=0,v=r.length;v>m;m++)p=r[m],void 0!==t[p]&&(f[p]=t[p]);for(var p in u)f.setRequestHeader(p,u[p]);return f.send(i),f},e.nanoajax=t}({},function(){return this}());

/* 参考实现jQuery.param序列化方法 */
(function(a){var b=a.Tools||{},toString={}.toString;b.stringify=function(f){var e=[];for(var c in f){d(c,f[c],function(h,g){var i=typeof g==="function"?g():g;e[e.length]=encodeURIComponent(h)+"="+encodeURIComponent(i==null?"":i)})}function d(g,k,j){if(toString.apply(k)==="[object Array]"){for(var h=0;h<k.length;h++){if(/\[\]$/.test(g)){j(g,k[h])}else{d(g+"["+(typeof k[h]==="object"&&k[h]!=null?h:"")+"]",k[h])}}}else{if(toString.apply(k)==="[object Object]"){for(name in k){d(g+"["+name+"]",k[name],j)}}else{j(g,k)}}}return e.join("&")};a.Tools=b})(window);